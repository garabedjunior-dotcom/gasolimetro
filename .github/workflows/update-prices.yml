name: Atualizar Precos Diariamente

on:
  schedule:
    # Executa todo dia as 8h BRT (11h UTC)
    - cron: '0 11 * * *'
  workflow_dispatch:
    # Permite execucao manual

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: Chamar API de Atualizacao
        run: |
          curl -X POST https://gasolimetro.vercel.app/api/update-prices \
               -H "Content-Type: application/json"
          
          # Aguardar 5 segundos para garantir que a atualizacao foi processada
          sleep 5
          
          # Verificar se a atualizacao foi bem-sucedida
          curl -s https://gasolimetro.vercel.app/api/prices | jq '.success' || echo "Falha ao atualizar precos"
